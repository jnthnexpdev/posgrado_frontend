<section class="center-center-column pd-24">
    <article class="center-center-column container pd-24">
        <h3 class="title-3 mb-24"> Periodos </h3>
        <span class="text-normal mb-24"> Periodos registrados en el sistema de informacion de posgrado </span>

        <div class="filters mb-24">
            <div class="actions">
              <button class="btn-prim center-center-row hover"
              (click)="downloadPeriods()">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M19.5 18v3h-15v-3H3v3a1.5 1.5 0 0 0 1.5 1.5h15A1.5 1.5 0 0 0 21 21v-3h-1.5Z"></path>
                    <path d="m19.5 10.5-1.058-1.057-5.692 5.684V1.5h-1.5v13.627L5.558 9.444 4.5 10.5 12 18l7.5-7.5Z"></path>
                </svg>
                <span class="text-small">Descargar PDF</span>
              </button>
    
              <button class="btn-prim center-center-row hover" (click)="openDialogRegister()">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M19.5 3h-3V1.5H15V3H9V1.5H7.5V3h-3C3.675 3 3 3.675 3 4.5v15c0 .825.675 1.5 1.5 1.5h15c.825 0 1.5-.675 1.5-1.5v-15c0-.825-.675-1.5-1.5-1.5Zm0 16.5h-15V9h15v10.5Zm0-12h-15v-3h3V6H9V4.5h6V6h1.5V4.5h3v3Z"></path>
                </svg>
                <span class="text-small">Registrar</span>
              </button>
            </div>
    
            <div class="input-search">
                <input 
                type="text"
                placeholder="Buscar periodo">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="m21.75 20.692-5.664-5.664a8.264 8.264 0 1 0-1.06 1.061l5.664 5.664 1.06-1.06ZM3 9.753a6.75 6.75 0 1 1 6.75 6.75A6.758 6.758 0 0 1 3 9.753Z"></path>
                </svg>
            </div>
        </div>

        @if(periods.length >= 1){
          @defer(on timer(2000ms)){
            <main class="mb-16">
              <table>
                <thead>
                  <tr>
                    <th class="text-normal">No</th>
                    <th class="text-normal">Periodo</th>
                    <th class="text-normal">Fecha registro</th>
                    <th class="text-normal">Alumnos registrados</th>
                    <th class="text-normal">Opciones</th>
                  </tr>
                </thead>
                <tbody>
                  @for(period of periods; track $index; let i = $index){
                    <tr>
                      <td class="text-small">{{(pagination.page - 1) * pagination.pageSize + $index + 1 }}</td>
                      <td class="text-small">{{period.periodo}}</td>
                      <td class="text-small">{{period.fechaRegistro}}</td>
                      <td class="text-small">{{period.alumnos.length}}</td>
                      <td class="text-small"> 
                        <button class="btn-sec hover" (click)="deletePeriod(period._id)"> Eliminar </button> 
                      </td>
                    </tr>
                  }
                </tbody>
              </table>
            </main>
            
            @if(pagination.totalPages > 1){
              <div class="pagination center-center-row">
                <button class="btn-prev" 
                [disabled]="pagination.page === 1" 
                (click)="changePage(pagination.page - 1)">
                Ant
                </button>
                @for (page of pages; track $index){
                  <button [ngClass]="pagination.page === page ? 'btn-page current-page'  : 'btn-page'"
                  (click)="changePage(page)">
                    {{page}}
                  </button>
                }
                <button class="btn-next" 
                [disabled]="pagination.totalPages === pagination.page"
                (click)="changePage(pagination.page + 1)">
                Sig
                </button>
              </div>
            }
          }@placeholder(minimum 2s;){
              <div class="center-center-column loading">
                <div class="loader"></div>
                <span class="text-small mt-24"> Cargando informacion  </span>
              </div>
          }
        }@else if (periods.length === 0 && requestCompleted()){
          <div class="center-center-column empty">
            <span class="text-small"> Por el momento no hay periodos registrados en el sistema </span>
          </div>
        }
    </article>

</section>